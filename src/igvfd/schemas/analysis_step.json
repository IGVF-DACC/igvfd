{
    "title": "Analysis Step",
    "description": "Schema for submitting a step in a computational analysis workflow.",
    "$id": "/profiles/analysis_step.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "type": "object",
    "required": [
        "title",
        "step_label",
        "analysis_step_types",
        "input_content_types",
        "major_version"
    ],
    "identifyingProperties": [
        "uuid",
        "aliases"
    ],
    "additionalProperties": false,
    "mixinProperties": [
        {
            "$ref": "mixins.json#/basic_item"
        },
        {
            "$ref": "mixins.json#/attribution"
        },
        {
            "$ref": "mixins.json#/standard_status"
        }
    ],
    "dependentSchemas": {},
    "properties": {
        "schema_version": {
            "default": "1"
        },
        "analysis_step_types": {
            "title": "Analysis Step Types",
            "description": "The classification of the software.",
            "type": "array",
            "uniqueItems": true,
            "items": {
                "title": "Type",
                "type": "string",
                "enum": [
                    "alignment",
                    "file format conversion",
                    "signal generation"
                ]
            }
        },
        "step_label": {
            "title": "Step Label",
            "description": "Unique lowercased label of the analysis step using a naming system where the pipeline, software used, the purpose is described, e.g. rampage-grit-peak-calling-step",
            "comment": "Unique for each parent analysis_step. Do not include version number in the label, it will be calculated.",
            "type": "string",
            "pattern": "^[a-z0-9-]+-step$"
        },
        "title": {
            "title": "Title",
            "description": "The preferred viewable name of the analysis step, likely the same as the name.",
            "type": "string",
            "pattern": "^[a-zA-Z\\d_().,-]+(?:\\s[a-zA-Z\\d_().,-]+)*[step|Step]$"
        },
        "major_version": {
            "title": "Major Version",
            "description": "The major version of the analysis step.",
            "type": "integer",
            "minimum": 1
        },
        "parents": {
            "title": "Parents",
            "description": "The precursor steps.",
            "uniqueItems": true,
            "type": "array",
            "items": {
                "description": "A precusor step.",
                "comment": "See analysis_step.json for available identifiers.",
                "type": "string",
                "linkTo": "AnalysisStep"
            }
        },
        "input_content_types": {
            "title": "Input Content Types",
            "description": "The content types used as input for the analysis step.",
            "type": "array",
            "uniqueItems": true,
            "items": {
                "title": "Input Content Type",
                "description": "A content type used as input for the analysis step.",
                "$merge": "#/$defs/content_types"
            }
        },
        "output_content_types": {
            "title": "Output Content Types",
            "description": "The content types produced as output by the analysis step.",
            "type": "array",
            "uniqueItems": true,
            "items": {
                "title": "Output Content Type",
                "description": "A content type produced as output by the analysis step.",
                "$merge": "#/$defs/content_types"
            }
        }
    },
    "$defs": {
        "content_types": {
            "type": "string",
            "enum": [
                "alignments",
                "transcriptome alignments",
                "exclusion list",
                "genome reference",
                "guide RNA sequences",
                "inclusion list",
                "sequence barcodes",
                "spike-ins",
                "transcriptome reference",
                "vector sequences",
                "reads",
                "subreads",
                "signal",
                "signal of all reads",
                "signal of unique reads",
                "signal p-value",
                "raw signal",
                "read-depth signal",
                "control signal",
                "fold over change control"
            ]
        }
    },
    "fuzzy_searchable_fields": [
        "title"
    ],
    "exact_searchable_fields": [
        "@type"
    ],
    "changelog": "/profiles/changelogs/analysis_step.md"
}
